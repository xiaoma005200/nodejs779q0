{"version":3,"sources":["../../src/api/Ruzhujilu.js"],"names":["config","db","api","get","req","res","page","parseInt","query","limit","sort","order","where","yudingdanhao","indexOf","Op","like","eq","fangjianmingcheng","fangjiantupian","dingdanjine","yudingriqi","ruzhushijian","ruzhurenshu","ruzhutianshu","banliriqi","tiwenqingkuang","xinxibeizhu","yonghuming","xingming","shouji","shenfenzheng","crossuserid","crossrefid","tableName","session","userinfo","undefined","jwt","decode","headers","token","username","userid","RuzhujiluModel","findAndCountAll","offset","result","currPage","pageSize","toRes","post","Object","keys","body","forEach","item","create","update","id","destroy","in","all","findOne","params","record","sql","type","remindstart","columnName","remindend","remindStart","util","getDateTimeFormat","Number","remindEnd","sequelize","plain","raw","QueryTypes","SELECT","results","count","xColumnName","yColumnName","timeStatType","role","dbConnection","dbtype","toLowerCase"],"mappings":";;;;;;;;;;;;;;;;;;AAAA;;AACA;;AACA;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;;;kBAGe,gBAAoB;AAAA,KAAjBA,MAAiB,QAAjBA,MAAiB;AAAA,KAATC,EAAS,QAATA,EAAS;;AAClC,KAAIC,MAAM,sBAAV;;AAGA;AACAA,KAAIC,GAAJ,CAAQ,OAAR;AAAA,uFAAiB,iBAAOC,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIXC,WAJW,GAIJC,SAASH,IAAII,KAAJ,CAAUF,IAAnB,KAA4B,CAJxB;AAKXG,YALW,GAKHF,SAASH,IAAII,KAAJ,CAAUC,KAAnB,KAA6B,EAL1B;AAMXC,WANW,GAMJN,IAAII,KAAJ,CAAUE,IAAV,IAAkB,IANd;AAOXC,YAPW,GAOHP,IAAII,KAAJ,CAAUG,KAAV,IAAmB,KAPhB;AASXC,YATW,GASH,EATG;AAUXC,mBAVW,GAUIT,IAAII,KAAJ,CAAUK,YAVd;;AAWf,WAAIA,YAAJ,EAAkB;;AAEjB,YAAIA,aAAaC,OAAb,CAAqB,GAArB,KAA6B,CAAC,CAAlC,EAAqC;AACpCF,eAAMC,YAAN,qCACEE,cAAGC,IADL,EACYH,YADZ;AAGA,SAJD,MAIO;AACND,eAAMC,YAAN,qCACEE,cAAGE,EADL,EACUJ,YADV;AAGA;AACD;AACGK,wBAvBW,GAuBSd,IAAII,KAAJ,CAAUU,iBAvBnB;;AAwBf,WAAIA,iBAAJ,EAAuB;;AAEtB,YAAIA,kBAAkBJ,OAAlB,CAA0B,GAA1B,KAAkC,CAAC,CAAvC,EAA0C;AACzCF,eAAMM,iBAAN,qCACEH,cAAGC,IADL,EACYE,iBADZ;AAGA,SAJD,MAIO;AACNN,eAAMM,iBAAN,qCACEH,cAAGE,EADL,EACUC,iBADV;AAGA;AACD;AACGC,qBApCW,GAoCMf,IAAII,KAAJ,CAAUW,cApChB;;AAqCf,WAAIA,cAAJ,EAAoB;;AAEnB,YAAIA,eAAeL,OAAf,CAAuB,GAAvB,KAA+B,CAAC,CAApC,EAAuC;AACtCF,eAAMO,cAAN,qCACEJ,cAAGC,IADL,EACYG,cADZ;AAGA,SAJD,MAIO;AACNP,eAAMO,cAAN,qCACEJ,cAAGE,EADL,EACUE,cADV;AAGA;AACD;AACGC,kBAjDW,GAiDGhB,IAAII,KAAJ,CAAUY,WAjDb;;AAkDf,WAAIA,WAAJ,EAAiB;;AAEhB,YAAIA,YAAYN,OAAZ,CAAoB,GAApB,KAA4B,CAAC,CAAjC,EAAoC;AACnCF,eAAMQ,WAAN,qCACEL,cAAGC,IADL,EACYI,WADZ;AAGA,SAJD,MAIO;AACNR,eAAMQ,WAAN,qCACEL,cAAGE,EADL,EACUG,WADV;AAGA;AACD;AACGC,iBA9DW,GA8DEjB,IAAII,KAAJ,CAAUa,UA9DZ;;AA+Df,WAAIA,UAAJ,EAAgB;;AAEf,YAAIA,WAAWP,OAAX,CAAmB,GAAnB,KAA2B,CAAC,CAAhC,EAAmC;AAClCF,eAAMS,UAAN,qCACEN,cAAGC,IADL,EACYK,UADZ;AAGA,SAJD,MAIO;AACNT,eAAMS,UAAN,qCACEN,cAAGE,EADL,EACUI,UADV;AAGA;AACD;AACGC,mBA3EW,GA2EIlB,IAAII,KAAJ,CAAUc,YA3Ed;;AA4Ef,WAAIA,YAAJ,EAAkB;;AAEjB,YAAIA,aAAaR,OAAb,CAAqB,GAArB,KAA6B,CAAC,CAAlC,EAAqC;AACpCF,eAAMU,YAAN,qCACEP,cAAGC,IADL,EACYM,YADZ;AAGA,SAJD,MAIO;AACNV,eAAMU,YAAN,qCACEP,cAAGE,EADL,EACUK,YADV;AAGA;AACD;AACGC,kBAxFW,GAwFGnB,IAAII,KAAJ,CAAUe,WAxFb;;AAyFf,WAAIA,WAAJ,EAAiB;;AAEhB,YAAIA,YAAYT,OAAZ,CAAoB,GAApB,KAA4B,CAAC,CAAjC,EAAoC;AACnCF,eAAMW,WAAN,qCACER,cAAGC,IADL,EACYO,WADZ;AAGA,SAJD,MAIO;AACNX,eAAMW,WAAN,qCACER,cAAGE,EADL,EACUM,WADV;AAGA;AACD;AACGC,mBArGW,GAqGIpB,IAAII,KAAJ,CAAUgB,YArGd;;AAsGf,WAAIA,YAAJ,EAAkB;;AAEjB,YAAIA,aAAaV,OAAb,CAAqB,GAArB,KAA6B,CAAC,CAAlC,EAAqC;AACpCF,eAAMY,YAAN,qCACET,cAAGC,IADL,EACYQ,YADZ;AAGA,SAJD,MAIO;AACNZ,eAAMY,YAAN,qCACET,cAAGE,EADL,EACUO,YADV;AAGA;AACD;AACGC,gBAlHW,GAkHCrB,IAAII,KAAJ,CAAUiB,SAlHX;;AAmHf,WAAIA,SAAJ,EAAe;;AAEd,YAAIA,UAAUX,OAAV,CAAkB,GAAlB,KAA0B,CAAC,CAA/B,EAAkC;AACjCF,eAAMa,SAAN,qCACEV,cAAGC,IADL,EACYS,SADZ;AAGA,SAJD,MAIO;AACNb,eAAMa,SAAN,qCACEV,cAAGE,EADL,EACUQ,SADV;AAGA;AACD;AACGC,qBA/HW,GA+HMtB,IAAII,KAAJ,CAAUkB,cA/HhB;;AAgIf,WAAIA,cAAJ,EAAoB;;AAEnB,YAAIA,eAAeZ,OAAf,CAAuB,GAAvB,KAA+B,CAAC,CAApC,EAAuC;AACtCF,eAAMc,cAAN,qCACEX,cAAGC,IADL,EACYU,cADZ;AAGA,SAJD,MAIO;AACNd,eAAMc,cAAN,qCACEX,cAAGE,EADL,EACUS,cADV;AAGA;AACD;AACGC,kBA5IW,GA4IGvB,IAAII,KAAJ,CAAUmB,WA5Ib;;AA6If,WAAIA,WAAJ,EAAiB;;AAEhB,YAAIA,YAAYb,OAAZ,CAAoB,GAApB,KAA4B,CAAC,CAAjC,EAAoC;AACnCF,eAAMe,WAAN,qCACEZ,cAAGC,IADL,EACYW,WADZ;AAGA,SAJD,MAIO;AACNf,eAAMe,WAAN,qCACEZ,cAAGE,EADL,EACUU,WADV;AAGA;AACD;AACGC,iBAzJW,GAyJExB,IAAII,KAAJ,CAAUoB,UAzJZ;;AA0Jf,WAAIA,UAAJ,EAAgB;;AAEf,YAAIA,WAAWd,OAAX,CAAmB,GAAnB,KAA2B,CAAC,CAAhC,EAAmC;AAClCF,eAAMgB,UAAN,qCACEb,cAAGC,IADL,EACYY,UADZ;AAGA,SAJD,MAIO;AACNhB,eAAMgB,UAAN,qCACEb,cAAGE,EADL,EACUW,UADV;AAGA;AACD;AACGC,eAtKW,GAsKAzB,IAAII,KAAJ,CAAUqB,QAtKV;;AAuKf,WAAIA,QAAJ,EAAc;;AAEb,YAAIA,SAASf,OAAT,CAAiB,GAAjB,KAAyB,CAAC,CAA9B,EAAiC;AAChCF,eAAMiB,QAAN,qCACEd,cAAGC,IADL,EACYa,QADZ;AAGA,SAJD,MAIO;AACNjB,eAAMiB,QAAN,qCACEd,cAAGE,EADL,EACUY,QADV;AAGA;AACD;AACGC,aAnLW,GAmLF1B,IAAII,KAAJ,CAAUsB,MAnLR;;AAoLf,WAAIA,MAAJ,EAAY;;AAEX,YAAIA,OAAOhB,OAAP,CAAe,GAAf,KAAuB,CAAC,CAA5B,EAA+B;AAC9BF,eAAMkB,MAAN,qCACEf,cAAGC,IADL,EACYc,MADZ;AAGA,SAJD,MAIO;AACNlB,eAAMkB,MAAN,qCACEf,cAAGE,EADL,EACUa,MADV;AAGA;AACD;AACGC,mBAhMW,GAgMI3B,IAAII,KAAJ,CAAUuB,YAhMd;;AAiMf,WAAIA,YAAJ,EAAkB;;AAEjB,YAAIA,aAAajB,OAAb,CAAqB,GAArB,KAA6B,CAAC,CAAlC,EAAqC;AACpCF,eAAMmB,YAAN,qCACEhB,cAAGC,IADL,EACYe,YADZ;AAGA,SAJD,MAIO;AACNnB,eAAMmB,YAAN,qCACEhB,cAAGE,EADL,EACUc,YADV;AAGA;AACD;AACGC,kBA7MW,GA6MG5B,IAAII,KAAJ,CAAUwB,WA7Mb;;AA8Mf,WAAIA,WAAJ,EAAiB;;AAEhB,YAAIA,YAAYlB,OAAZ,CAAoB,GAApB,KAA4B,CAAC,CAAjC,EAAoC;AACnCF,eAAMoB,WAAN,qCACEjB,cAAGC,IADL,EACYgB,WADZ;AAGA,SAJD,MAIO;AACNpB,eAAMoB,WAAN,qCACEjB,cAAGE,EADL,EACUe,WADV;AAGA;AACD;AACGC,iBA1NW,GA0NE7B,IAAII,KAAJ,CAAUyB,UA1NZ;;AA2Nf,WAAIA,UAAJ,EAAgB;;AAEf,YAAIA,WAAWnB,OAAX,CAAmB,GAAnB,KAA2B,CAAC,CAAhC,EAAmC;AAClCF,eAAMqB,UAAN,qCACElB,cAAGC,IADL,EACYiB,UADZ;AAGA,SAJD,MAIO;AACNrB,eAAMqB,UAAN,qCACElB,cAAGE,EADL,EACUgB,UADV;AAGA;AACD;AACD;AACIC,gBAxOW,GAwOC9B,IAAI+B,OAAJ,CAAYC,QAAZ,KAAyBC,SAAzB,GAAqCC,uBAAIC,MAAJ,CAAWnC,IAAIoC,OAAJ,CAAYC,KAAvB,EAA8BP,SAAnE,GAA+E9B,IAAI+B,OAAJ,CAAYC,QAAZ,CAAqBF,SAxOrG;;AAyOf,WAAGA,aAAa,SAAhB,EAA2B;AAC1BtB,cAAMgB,UAAN,qCACEb,cAAGE,EADL,EACUb,IAAI+B,OAAJ,CAAYC,QAAZ,KAAyBC,SAAzB,GAAqCC,uBAAIC,MAAJ,CAAWnC,IAAIoC,OAAJ,CAAYC,KAAvB,EAA8BC,QAAnE,GAA8EtC,IAAI+B,OAAJ,CAAYC,QAAZ,CAAqBR,UAD7G;AAGA,YAAIhB,MAAM,QAAN,KAAmByB,SAAvB,EAAkC;AACjC,gBAAOzB,MAAM+B,MAAb;AACA;AACD;;AAhPc;AAAA,cAkPIC,yBAAeC,eAAf,CAA+B;AACjDlC,eAAO,CAAC,CAACD,IAAD,EAAOC,KAAP,CAAD,CAD0C;AAEjDC,oBAFiD;AAGjDkC,gBAAQ,CAACxC,OAAO,CAAR,IAAaG,KAH4B;AAIjDA;AAJiD,QAA/B,CAlPJ;;AAAA;AAkPXsC,aAlPW;;;AAyPfA,cAAOC,QAAP,GAAkB1C,IAAlB;AACAyC,cAAOE,QAAP,GAAkBxC,KAAlB;;AAEAyC,uBAAM5C,IAAN,CAAWD,GAAX,EAAgB,CAAhB,EAAmB0C,MAAnB;AA5Pe;AAAA;;AAAA;AAAA;AAAA;;;AA+PfG,uBAAMf,OAAN,CAAc9B,GAAd,EAAmB,GAAnB,EAAwB,QAAxB,EAAkC,EAAlC,EAAsC,GAAtC;;AA/Pe;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAjB;;AAAA;AAAA;AAAA;AAAA;;AAmQG;AACHH,KAAIC,GAAJ,CAAQ,OAAR;AAAA,uFAAiB,kBAAOC,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIXC,WAJW,GAIJC,SAASH,IAAII,KAAJ,CAAUF,IAAnB,KAA4B,CAJxB;AAKXG,YALW,GAKHF,SAASH,IAAII,KAAJ,CAAUC,KAAnB,KAA6B,EAL1B;AAMXC,WANW,GAMJN,IAAII,KAAJ,CAAUE,IAAV,IAAkB,IANd;AAOXC,YAPW,GAOHP,IAAII,KAAJ,CAAUG,KAAV,IAAmB,KAPhB;AASXC,YATW,GASH,EATG;AAUXoB,kBAVW,GAUG5B,IAAII,KAAJ,CAAUwB,WAVb;;AAWf,WAAIA,WAAJ,EAAiB;AAChBpB,cAAMoB,WAAN,qCACEjB,cAAGE,EADL,EACUe,WADV;AAGA;AACGC,iBAhBW,GAgBE7B,IAAII,KAAJ,CAAUyB,UAhBZ;;AAiBf,WAAIA,UAAJ,EAAgB;AACfrB,cAAMqB,UAAN,qCACElB,cAAGE,EADL,EACUgB,UADV;AAGA;AACGpB,mBAtBW,GAsBIT,IAAII,KAAJ,CAAUK,YAtBd;;AAuBf,WAAIA,YAAJ,EAAkB;;AAEjB,YAAIA,aAAaC,OAAb,CAAqB,GAArB,KAA6B,CAAC,CAAlC,EAAqC;AACpCF,eAAMC,YAAN,qCACEE,cAAGC,IADL,EACYH,YADZ;AAGA,SAJD,MAIO;AACND,eAAMC,YAAN,qCACEE,cAAGE,EADL,EACUJ,YADV;AAGA;AACD;AACGK,wBAnCW,GAmCSd,IAAII,KAAJ,CAAUU,iBAnCnB;;AAoCf,WAAIA,iBAAJ,EAAuB;;AAEtB,YAAIA,kBAAkBJ,OAAlB,CAA0B,GAA1B,KAAkC,CAAC,CAAvC,EAA0C;AACzCF,eAAMM,iBAAN,qCACEH,cAAGC,IADL,EACYE,iBADZ;AAGA,SAJD,MAIO;AACNN,eAAMM,iBAAN,qCACEH,cAAGE,EADL,EACUC,iBADV;AAGA;AACD;;AA/Cc;AAAA,cAkDI0B,yBAAeC,eAAf,CAA+B;AACjDlC,eAAO,CAAC,CAACD,IAAD,EAAOC,KAAP,CAAD,CAD0C;AAEjDC,oBAFiD;AAGjDkC,gBAAQ,CAACxC,OAAO,CAAR,IAAaG,KAH4B;AAIjDA;AAJiD,QAA/B,CAlDJ;;AAAA;AAkDXsC,aAlDW;;;AAyDfA,cAAOC,QAAP,GAAkB1C,IAAlB;AACAyC,cAAOE,QAAP,GAAkBxC,KAAlB;;AAEAyC,uBAAM5C,IAAN,CAAWD,GAAX,EAAgB,CAAhB,EAAmB0C,MAAnB;AA5De;AAAA;;AAAA;AAAA;AAAA;;;AA+DfG,uBAAMf,OAAN,CAAc9B,GAAd,EAAmB,GAAnB,EAAwB,SAAxB,EAAmC,EAAnC,EAAuC,GAAvC;;AA/De;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAjB;;AAAA;AAAA;AAAA;AAAA;;AAoEA;AACAH,KAAIiD,IAAJ,CAAS,OAAT;AAAA,uFAAkB,kBAAO/C,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;AAIhB+C,cAAOC,IAAP,CAAYjD,IAAIkD,IAAhB,EAAsBC,OAAtB,CAA8B,gBAAM;AACnC,YAAGnD,IAAIkD,IAAJ,CAASE,IAAT,KAAkB,EAArB,EAA0B,OAAOpD,IAAIkD,IAAJ,CAASE,IAAT,CAAP;AAC1B,QAFD;;AAJgB;AAAA,cAUOZ,yBAAea,MAAf,CAAsBrD,IAAIkD,IAA1B,CAVP;;AAAA;AAUVlB,eAVU;;;AAYhB,WAAIA,aAAa,IAAjB,EAAuB;;AAEtBc,wBAAMf,OAAN,CAAc9B,GAAd,EAAmB,CAAC,CAApB,EAAuB,OAAvB;AACA,QAHD,MAGO;;AAEN6C,wBAAMf,OAAN,CAAc9B,GAAd,EAAmB,CAAnB,EAAsB,OAAtB;AACA;AAlBe;AAAA;;AAAA;AAAA;AAAA;;;AAqBhB6C,uBAAMf,OAAN,CAAc9B,GAAd,EAAmB,GAAnB,EAAwB,QAAxB,EAAkC,EAAlC,EAAsC,GAAtC;;AArBgB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAlB;;AAAA;AAAA;AAAA;AAAA;;AAyBG;AACHH,KAAIiD,IAAJ,CAAS,MAAT;AAAA,uFAAiB,kBAAO/C,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;AAIf+C,cAAOC,IAAP,CAAYjD,IAAIkD,IAAhB,EAAsBC,OAAtB,CAA8B,gBAAM;AACnC,YAAGnD,IAAIkD,IAAJ,CAASE,IAAT,KAAkB,EAArB,EAA0B,OAAOpD,IAAIkD,IAAJ,CAASE,IAAT,CAAP;AAC1B,QAFD;;AAIA,WAAIlB,uBAAIC,MAAJ,CAAWnC,IAAIoC,OAAJ,CAAYC,KAAvB,KAAiC,IAArC,EAA2C;AAC1CS,wBAAMf,OAAN,CAAc9B,GAAd,EAAmB,GAAnB,EAAwB,SAAxB,EAAmC,EAAnC,EAAuC,GAAvC;AACA;;AAVc;AAAA,cAcQuC,yBAAea,MAAf,CAAsBrD,IAAIkD,IAA1B,CAdR;;AAAA;AAcTlB,eAdS;;;AAgBf,WAAIA,aAAa,IAAjB,EAAuB;;AAEtBc,wBAAMf,OAAN,CAAc9B,GAAd,EAAmB,CAAC,CAApB,EAAuB,OAAvB;AACA,QAHD,MAGO;;AAEN6C,wBAAMf,OAAN,CAAc9B,GAAd,EAAmB,CAAnB,EAAsB,OAAtB;AACA;AAtBc;AAAA;;AAAA;AAAA;AAAA;;;AAyBf6C,uBAAMf,OAAN,CAAc9B,GAAd,EAAmB,GAAnB,EAAwB,QAAxB,EAAkC,EAAlC,EAAsC,GAAtC;;AAzBe;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAjB;;AAAA;AAAA;AAAA;AAAA;;AA6BA;AACAH,KAAIiD,IAAJ,CAAS,SAAT;AAAA,uFAAoB,kBAAO/C,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAMZuC,yBAAec,MAAf,CAAsBtD,IAAIkD,IAA1B,EAAgC;AACrC1C,eAAO;AACL+C,aAAIvD,IAAIkD,IAAJ,CAASK,EAAT,IAAe;AADd;AAD8B,QAAhC,CANY;;AAAA;;AAalBT,uBAAMf,OAAN,CAAc9B,GAAd,EAAmB,CAAnB,EAAsB,OAAtB;AAbkB;AAAA;;AAAA;AAAA;AAAA;;;AAgBlB6C,uBAAMf,OAAN,CAAc9B,GAAd,EAAmB,GAAnB,EAAwB,QAAxB,EAAkC,EAAlC,EAAsC,GAAtC;;AAhBkB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAApB;;AAAA;AAAA;AAAA;AAAA;;AAoBA;AACAH,KAAIiD,IAAJ,CAAS,SAAT;AAAA,uFAAoB,kBAAO/C,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAIZuC,yBAAegB,OAAf,CAAuB;AAC5BhD,eAAO;AACL+C,+CACA5C,cAAG8C,EADH,EACQzD,IAAIkD,IADZ;AADK;AADqB,QAAvB,CAJY;;AAAA;;AAYlBJ,uBAAMf,OAAN,CAAc9B,GAAd,EAAmB,CAAnB,EAAsB,OAAtB;AAZkB;AAAA;;AAAA;AAAA;AAAA;;;AAelB6C,uBAAMf,OAAN,CAAc9B,GAAd,EAAmB,GAAnB,EAAwB,QAAxB,EAAkC,EAAlC,EAAsC,GAAtC;;AAfkB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAApB;;AAAA;AAAA;AAAA;AAAA;;AAmBA;AACAH,KAAI4D,GAAJ,CAAQ,WAAR;AAAA,uFAAqB,kBAAO1D,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBAKnB6C,eALmB;AAAA,sBAKN7C,GALM;AAAA;AAAA,cAKQuC,yBAAemB,OAAf,CAAuB,EAAEnD,OAAO,EAAE+C,IAAIvD,IAAI4D,MAAJ,CAAWL,EAAjB,EAAT,EAAvB,CALR;;AAAA;AAAA;;AAAA,oBAKbM,MALa,kCAKD,CALC;;AAAA;AAAA;;AAAA;AAAA;AAAA;;;AAQnBf,uBAAMf,OAAN,CAAc9B,GAAd,EAAmB,GAAnB,EAAwB,QAAxB,EAAkC,EAAlC,EAAsC,GAAtC;;AARmB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAArB;;AAAA;AAAA;AAAA;AAAA;;AAYG;AACHH,KAAI4D,GAAJ,CAAQ,aAAR;AAAA,uFAAuB,kBAAO1D,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBAKrB6C,eALqB;AAAA,sBAKR7C,GALQ;AAAA;AAAA,cAKMuC,yBAAemB,OAAf,CAAuB,EAAEnD,OAAO,EAAE+C,IAAIvD,IAAI4D,MAAJ,CAAWL,EAAjB,EAAT,EAAvB,CALN;;AAAA;AAAA;;AAAA,oBAKfM,MALe,kCAKH,CALG;;AAAA;AAAA;;AAAA;AAAA;AAAA;;;AAQrBf,uBAAMf,OAAN,CAAc9B,GAAd,EAAmB,GAAnB,EAAwB,QAAxB,EAAkC,EAAlC,EAAsC,GAAtC;;AARqB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAvB;;AAAA;AAAA;AAAA;AAAA;;AAYA;AACAH,KAAIC,GAAJ,CAAQ,2BAAR;AAAA,wFAAqC,kBAAOC,GAAP,EAAYC,GAAZ;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAI/B6D,UAJ+B,GAIzB,mBAJyB;;;AAMnC,WAAI9D,IAAI4D,MAAJ,CAAWG,IAAX,IAAmB,CAAvB,EAA0B;AACzB,YAAI/D,IAAII,KAAJ,CAAU4D,WAAd,EAA2BF,MAAM,mDAAmD9D,IAAI4D,MAAJ,CAAWK,UAA9D,GAA2E,OAA3E,GAAqFjE,IAAII,KAAJ,CAAU4D,WAA/F,GAA6G,GAAnH;AAC3B,YAAIhE,IAAII,KAAJ,CAAU8D,SAAd,EAAyBJ,MAAM,mDAAmD9D,IAAI4D,MAAJ,CAAWK,UAA9D,GAA2E,OAA3E,GAAqFjE,IAAII,KAAJ,CAAU8D,SAA/F,GAA2G,GAAjH;;AAEzB,YAAIlE,IAAII,KAAJ,CAAU4D,WAAV,IAAyBhE,IAAII,KAAJ,CAAU8D,SAAvC,EAAkD;AACjDJ,eAAM,mDAAmD9D,IAAI4D,MAAJ,CAAWK,UAA9D,GAA2E,OAA3E,GAAqFjE,IAAII,KAAJ,CAAU4D,WAA/F,GAA6G,QAA7G,GAAwHhE,IAAI4D,MAAJ,CAAWK,UAAnI,GAAgJ,OAAhJ,GAA0JjE,IAAII,KAAJ,CAAU8D,SAApK,GAAgL,GAAtL;AACA;AACD;;AAED,WAAIlE,IAAI4D,MAAJ,CAAWG,IAAX,IAAmB,CAAvB,EAA0B;AACzB,YAAI/D,IAAII,KAAJ,CAAU4D,WAAd,EAA2B;AACtBG,oBADsB,GACRC,eAAKC,iBAAL,CAAuB,IAAIC,OAAOtE,IAAII,KAAJ,CAAU4D,WAAjB,CAA3B,EAA0D,YAA1D,CADQ;;AAE1BF,eAAM,mDAAmD9D,IAAI4D,MAAJ,CAAWK,UAA9D,GAA2E,OAA3E,GAAqFE,WAArF,GAAmG,GAAzG;AACA;AACD,YAAInE,IAAII,KAAJ,CAAU8D,SAAd,EAAyB;AACpBK,kBADoB,GACRH,eAAKC,iBAAL,CAAuBrE,IAAII,KAAJ,CAAU8D,SAAjC,EAA4C,YAA5C,CADQ;;AAExBJ,eAAM,mDAAmD9D,IAAI4D,MAAJ,CAAWK,UAA9D,GAA2E,OAA3E,GAAqFM,SAArF,GAAiG,GAAvG;AACA;;AAED,YAAIvE,IAAII,KAAJ,CAAU4D,WAAV,IAAyBhE,IAAII,KAAJ,CAAU8D,SAAvC,EAAkD;AAC7CC,qBAD6C,GAC/BC,eAAKC,iBAAL,CAAuB,IAAIC,OAAOtE,IAAII,KAAJ,CAAU4D,WAAjB,CAA3B,EAA0D,YAA1D,CAD+B;AAE7CO,mBAF6C,GAEjCH,eAAKC,iBAAL,CAAuBrE,IAAII,KAAJ,CAAU8D,SAAjC,EAA4C,YAA5C,CAFiC;;AAGjDJ,eAAM,mDAAmD9D,IAAI4D,MAAJ,CAAWK,UAA9D,GAA2E,OAA3E,GAAqFE,YAArF,GAAmG,QAAnG,GAA8GnE,IAAI4D,MAAJ,CAAWK,UAAzH,GAAsI,OAAtI,GAAgJM,UAAhJ,GAA4J,GAAlK;AACA;AACD;;AA9BkC;AAAA,cAgCbC,oBAAUpE,KAAV,CAAgB0D,GAAhB,EAAqB;AAC1CW,eAAO,IADmC;AAE1CC,aAAK,IAFqC;AAG1CX,cAAMY,sBAAWC;AAHyB,QAArB,CAhCa;;AAAA;AAgC7BC,cAhC6B;;;AAsCnC/B,uBAAMgC,KAAN,CAAY7E,GAAZ,EAAiB,CAAjB,EAAoB4E,QAAQC,KAA5B;AAtCmC;AAAA;;AAAA;AAAA;AAAA;;;AAyCnChC,uBAAMf,OAAN,CAAc9B,GAAd,EAAmB,GAAnB,EAAwB,QAAxB,EAAkC,EAAlC,EAAsC,GAAtC;;AAzCmC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAArC;;AAAA;AAAA;AAAA;AAAA;;AAsDA;AACAH,KAAIC,GAAJ,CAAQ,oBAAR;AAAA,wFAA8B,mBAAOC,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIxB6D,UAJwB,GAIlB,EAJkB;AAKxBG,iBALwB,GAKXjE,IAAI4D,MAAJ,CAAWK,UALA;AAM5B;;AACIzD,YAPwB,GAOhB,eAPgB;AAQxBsB,gBARwB,GAQZ9B,IAAI+B,OAAJ,CAAYC,QAAZ,KAAyBC,SAAzB,GAAqCC,uBAAIC,MAAJ,CAAWnC,IAAIoC,OAAJ,CAAYC,KAAvB,EAA8BP,SAAnE,GAA+E9B,IAAI+B,OAAJ,CAAYC,QAAZ,CAAqBF,SARxF;;AAS5B,WAAGA,aAAa,SAAhB,EAA2B;AAC1BtB,iBAAS,wBAAwB0B,uBAAIC,MAAJ,CAAWnC,IAAIoC,OAAJ,CAAYC,KAAvB,EAA8BC,QAAtD,GAAiE,IAA1E;AACA;AACDwB,aAAM,+BAA+BG,UAA/B,GAA4C,kBAA5C,GAAiEzD,KAAjE,GAAyE,YAAzE,GAAwFyD,UAAxF,GAAqG,WAA3G;AAZ4B,uBAa5BnB,eAb4B;AAAA,uBAaf7C,GAbe;AAAA;AAAA,cAaDuE,oBAAUpE,KAAV,CAAgB0D,GAAhB,EAAqB;AAC/CW,eAAO,KADwC;AAE/CC,aAAK,IAF0C;AAG/CX,cAAMY,sBAAWC;AAH8B,QAArB,CAbC;;AAAA;AAAA;;AAAA,qBAatBf,MAbsB,oCAaV,CAbU;;AAAA;AAAA;;AAAA;AAAA;AAAA;;;AAoB5Bf,uBAAMf,OAAN,CAAc9B,GAAd,EAAmB,GAAnB,EAAwB,QAAxB,EAAkC,EAAlC,EAAsC,GAAtC;;AApB4B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAA9B;;AAAA;AAAA;AAAA;AAAA;;AAwBA;AACAH,KAAIC,GAAJ,CAAQ,kCAAR;AAAA,wFAA4C,mBAAOC,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAItC6D,UAJsC,GAIhC,EAJgC;AAKtCiB,kBALsC,GAKxB/E,IAAI4D,MAAJ,CAAWmB,WALa;AAMtCC,kBANsC,GAMxBhF,IAAI4D,MAAJ,CAAWoB,WANa;AAO1C;;AACIxE,YARsC,GAQ9B,eAR8B;AAStCsB,gBATsC,GAS1B9B,IAAI+B,OAAJ,CAAYC,QAAZ,KAAyBC,SAAzB,GAAqCC,uBAAIC,MAAJ,CAAWnC,IAAIoC,OAAJ,CAAYC,KAAvB,EAA8BP,SAAnE,GAA+E9B,IAAI+B,OAAJ,CAAYC,QAAZ,CAAqBF,SAT1E;;AAU1C,WAAGA,aAAa,SAAhB,EAA2B;AAC1BtB,iBAAS,wBAAwB0B,uBAAIC,MAAJ,CAAWnC,IAAIoC,OAAJ,CAAYC,KAAvB,EAA8BC,QAAtD,GAAiE,IAA1E;AACA;AACD,WAAI,eAAe,QAAnB,EAA6B;AAC5B9B,iBAAS,uCAAT;AACA;;AAEDsD,aAAM,YAAYiB,WAAZ,GAA0B,QAA1B,GAAqCC,WAArC,GAAmD,4BAAnD,GAAkFxE,KAAlF,GAA0F,YAA1F,GAAyGuE,WAAzG,GAAuH,gBAA7H;;AAjB0C,uBAmB1CjC,eAnB0C;AAAA,uBAmB7B7C,GAnB6B;AAAA;AAAA,cAmBfuE,oBAAUpE,KAAV,CAAgB0D,GAAhB,EAAqB;AAC/CW,eAAO,KADwC;AAE/CC,aAAK,IAF0C;AAG/CX,cAAMY,sBAAWC;AAH8B,QAArB,CAnBe;;AAAA;AAAA;;AAAA,qBAmBpCf,MAnBoC,oCAmBxB,CAnBwB;;AAAA;AAAA;;AAAA;AAAA;AAAA;;;AA0B1Cf,uBAAMf,OAAN,CAAc9B,GAAd,EAAmB,GAAnB,EAAwB,QAAxB,EAAkC,EAAlC,EAAsC,GAAtC;;AA1B0C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAA5C;;AAAA;AAAA;AAAA;AAAA;;AA8BA;AACAH,KAAIC,GAAJ,CAAQ,gDAAR;AAAA,wFAA0D,mBAAOC,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIpD6D,UAJoD,GAI9C,EAJ8C;AAKpDiB,kBALoD,GAKtC/E,IAAI4D,MAAJ,CAAWmB,WAL2B;AAMpDC,kBANoD,GAMtChF,IAAI4D,MAAJ,CAAWoB,WAN2B;AAOpDC,mBAPoD,GAOrCjF,IAAI4D,MAAJ,CAAWqB,YAP0B;AAQpDnD,gBARoD,GAQxC,WARwC;AASpDtB,YAToD,GAS5C,eAT4C;;AAUxD,WAAI0B,uBAAIC,MAAJ,CAAWnC,IAAIoC,OAAJ,CAAYC,KAAvB,EAA8B6C,IAA9B,IAAsC,KAA1C,EAAiD;AAChD1E,iBAAS,wBAAwB0B,uBAAIC,MAAJ,CAAWnC,IAAIoC,OAAJ,CAAYC,KAAvB,EAA8BC,QAAtD,GAAiE,IAA1E;AACA;AACD,WAAI,eAAe,QAAnB,EAA6B;AAC5B9B,iBAAS,uCAAT;AACA;;AAEQ,WAAIZ,OAAOuF,YAAP,CAAoBC,MAApB,CAA2BC,WAA3B,MAA4C,OAAhD,EAAyD;AACrD,YAAIJ,gBAAgB,GAApB,EACInB,MAAM,wBAAwBiB,WAAxB,GAAsC,gBAAtC,GAAyDA,WAAzD,GAAuE,QAAvE,GAAkFC,WAAlF,GAAgG,eAAhG,GAAkHlD,SAAlH,GAA8HtB,KAA9H,GAAsI,wBAAtI,GAAiKuE,WAAjK,GAA+K,wBAArL;AACJ,YAAIE,gBAAgB,GAApB,EACInB,MAAM,wBAAwBiB,WAAxB,GAAsC,aAAtC,GAAsDA,WAAtD,GAAoE,QAApE,GAA+EC,WAA/E,GAA6F,eAA7F,GAA+GlD,SAA/G,GAA2HtB,KAA3H,GAAmI,wBAAnI,GAA8JuE,WAA9J,GAA4K,sBAAlL;AACJ,YAAIE,gBAAgB,GAApB,EACInB,MAAM,wBAAwBiB,WAAxB,GAAsC,UAAtC,GAAmDA,WAAnD,GAAiE,QAAjE,GAA4EC,WAA5E,GAA0F,eAA1F,GAA4GlD,SAA5G,GAAwHtB,KAAxH,GAAgI,wBAAhI,GAA2JuE,WAA3J,GAAyK,mBAA/K;AACP,QAPD,MAOO;AACH,YAAIE,gBAAgB,GAApB,EACInB,MAAM,oCAAoCiB,WAApC,GAAkD,SAAlD,GAA8DA,WAA9D,GAA4E,QAA5E,GAAuFC,WAAvF,GAAqG,eAArG,GAAuHlD,SAAvH,GAAmItB,KAAnI,GAA2I,oCAA3I,GAAkLuE,WAAlL,GAAgM,kBAAtM;AACJ,YAAIE,gBAAgB,GAApB,EACInB,MAAM,mCAAmCiB,WAAnC,GAAiD,SAAjD,GAA6DA,WAA7D,GAA2E,QAA3E,GAAsFC,WAAtF,GAAoG,eAApG,GAAsHlD,SAAtH,GAAkItB,KAAlI,GAA0I,mCAA1I,GAAgLuE,WAAhL,GAA8L,kBAApM;AACJ,YAAIE,gBAAgB,GAApB,EACInB,MAAM,mCAAmCiB,WAAnC,GAAiD,SAAjD,GAA6DA,WAA7D,GAA2E,QAA3E,GAAsFC,WAAtF,GAAoG,eAApG,GAAsHlD,SAAtH,GAAkItB,KAAlI,GAA0I,mCAA1I,GAAgLuE,WAAhL,GAA8L,kBAApM;AACP;AA/B8C,uBAgCxDjC,eAhCwD;AAAA,uBAgC3C7C,GAhC2C;AAAA;AAAA,cAgC7BuE,oBAAUpE,KAAV,CAAgB0D,GAAhB,EAAqB;AAC/CW,eAAO,KADwC;AAE/CC,aAAK,IAF0C;AAG/CX,cAAMY,sBAAWC;AAH8B,QAArB,CAhC6B;;AAAA;AAAA;;AAAA,qBAgClDf,MAhCkD,oCAgCtC,CAhCsC;;AAAA;AAAA;;AAAA;AAAA;AAAA;;;AAuCxDf,uBAAMf,OAAN,CAAc9B,GAAd,EAAmB,GAAnB,EAAwB,QAAxB,EAAkC,EAAlC,EAAsC,GAAtC;;AAvCwD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAA1D;;AAAA;AAAA;AAAA;AAAA;;AAiDA,QAAOH,GAAP;AACA,C","file":"Ruzhujilu.js","sourcesContent":["import { version } from '../../package.json'\r\nimport { Router } from 'express'\r\nimport { Sequelize, Op, QueryTypes } from 'sequelize'\r\nimport sequelize from '../models/sequelize'\r\nimport toRes from '../lib/toRes'\r\nimport RuzhujiluModel from '../models/RuzhujiluModel'\r\nimport md5 from 'md5-node'\r\nimport util from '../lib/util'\r\nimport jwt from 'jsonwebtoken'\r\nimport moment from 'moment'\r\n\r\n\r\nexport default ({ config, db }) => {\r\n\tlet api = Router()\r\n\r\n\r\n\t// 分页接口（后端）\r\n\tapi.get('/page', async (req, res) => {\r\n\r\n\t\ttry {\r\n\r\n\t\t\tlet page = parseInt(req.query.page) || 1\r\n\t\t\tlet limit = parseInt(req.query.limit) || 10\r\n\t\t\tlet sort = req.query.sort || 'id'\r\n\t\t\tlet order = req.query.order || 'asc'\r\n\r\n\t\t\tlet where = {}\r\n\t\t\tlet yudingdanhao = req.query.yudingdanhao\r\n\t\t\tif (yudingdanhao) {\r\n\r\n\t\t\t\tif (yudingdanhao.indexOf('%') != -1) {\r\n\t\t\t\t\twhere.yudingdanhao = {\r\n\t\t\t\t\t\t[Op.like]: yudingdanhao\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\twhere.yudingdanhao = {\r\n\t\t\t\t\t\t[Op.eq]: yudingdanhao\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tlet fangjianmingcheng = req.query.fangjianmingcheng\r\n\t\t\tif (fangjianmingcheng) {\r\n\r\n\t\t\t\tif (fangjianmingcheng.indexOf('%') != -1) {\r\n\t\t\t\t\twhere.fangjianmingcheng = {\r\n\t\t\t\t\t\t[Op.like]: fangjianmingcheng\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\twhere.fangjianmingcheng = {\r\n\t\t\t\t\t\t[Op.eq]: fangjianmingcheng\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tlet fangjiantupian = req.query.fangjiantupian\r\n\t\t\tif (fangjiantupian) {\r\n\r\n\t\t\t\tif (fangjiantupian.indexOf('%') != -1) {\r\n\t\t\t\t\twhere.fangjiantupian = {\r\n\t\t\t\t\t\t[Op.like]: fangjiantupian\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\twhere.fangjiantupian = {\r\n\t\t\t\t\t\t[Op.eq]: fangjiantupian\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tlet dingdanjine = req.query.dingdanjine\r\n\t\t\tif (dingdanjine) {\r\n\r\n\t\t\t\tif (dingdanjine.indexOf('%') != -1) {\r\n\t\t\t\t\twhere.dingdanjine = {\r\n\t\t\t\t\t\t[Op.like]: dingdanjine\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\twhere.dingdanjine = {\r\n\t\t\t\t\t\t[Op.eq]: dingdanjine\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tlet yudingriqi = req.query.yudingriqi\r\n\t\t\tif (yudingriqi) {\r\n\r\n\t\t\t\tif (yudingriqi.indexOf('%') != -1) {\r\n\t\t\t\t\twhere.yudingriqi = {\r\n\t\t\t\t\t\t[Op.like]: yudingriqi\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\twhere.yudingriqi = {\r\n\t\t\t\t\t\t[Op.eq]: yudingriqi\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tlet ruzhushijian = req.query.ruzhushijian\r\n\t\t\tif (ruzhushijian) {\r\n\r\n\t\t\t\tif (ruzhushijian.indexOf('%') != -1) {\r\n\t\t\t\t\twhere.ruzhushijian = {\r\n\t\t\t\t\t\t[Op.like]: ruzhushijian\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\twhere.ruzhushijian = {\r\n\t\t\t\t\t\t[Op.eq]: ruzhushijian\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tlet ruzhurenshu = req.query.ruzhurenshu\r\n\t\t\tif (ruzhurenshu) {\r\n\r\n\t\t\t\tif (ruzhurenshu.indexOf('%') != -1) {\r\n\t\t\t\t\twhere.ruzhurenshu = {\r\n\t\t\t\t\t\t[Op.like]: ruzhurenshu\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\twhere.ruzhurenshu = {\r\n\t\t\t\t\t\t[Op.eq]: ruzhurenshu\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tlet ruzhutianshu = req.query.ruzhutianshu\r\n\t\t\tif (ruzhutianshu) {\r\n\r\n\t\t\t\tif (ruzhutianshu.indexOf('%') != -1) {\r\n\t\t\t\t\twhere.ruzhutianshu = {\r\n\t\t\t\t\t\t[Op.like]: ruzhutianshu\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\twhere.ruzhutianshu = {\r\n\t\t\t\t\t\t[Op.eq]: ruzhutianshu\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tlet banliriqi = req.query.banliriqi\r\n\t\t\tif (banliriqi) {\r\n\r\n\t\t\t\tif (banliriqi.indexOf('%') != -1) {\r\n\t\t\t\t\twhere.banliriqi = {\r\n\t\t\t\t\t\t[Op.like]: banliriqi\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\twhere.banliriqi = {\r\n\t\t\t\t\t\t[Op.eq]: banliriqi\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tlet tiwenqingkuang = req.query.tiwenqingkuang\r\n\t\t\tif (tiwenqingkuang) {\r\n\r\n\t\t\t\tif (tiwenqingkuang.indexOf('%') != -1) {\r\n\t\t\t\t\twhere.tiwenqingkuang = {\r\n\t\t\t\t\t\t[Op.like]: tiwenqingkuang\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\twhere.tiwenqingkuang = {\r\n\t\t\t\t\t\t[Op.eq]: tiwenqingkuang\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tlet xinxibeizhu = req.query.xinxibeizhu\r\n\t\t\tif (xinxibeizhu) {\r\n\r\n\t\t\t\tif (xinxibeizhu.indexOf('%') != -1) {\r\n\t\t\t\t\twhere.xinxibeizhu = {\r\n\t\t\t\t\t\t[Op.like]: xinxibeizhu\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\twhere.xinxibeizhu = {\r\n\t\t\t\t\t\t[Op.eq]: xinxibeizhu\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tlet yonghuming = req.query.yonghuming\r\n\t\t\tif (yonghuming) {\r\n\r\n\t\t\t\tif (yonghuming.indexOf('%') != -1) {\r\n\t\t\t\t\twhere.yonghuming = {\r\n\t\t\t\t\t\t[Op.like]: yonghuming\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\twhere.yonghuming = {\r\n\t\t\t\t\t\t[Op.eq]: yonghuming\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tlet xingming = req.query.xingming\r\n\t\t\tif (xingming) {\r\n\r\n\t\t\t\tif (xingming.indexOf('%') != -1) {\r\n\t\t\t\t\twhere.xingming = {\r\n\t\t\t\t\t\t[Op.like]: xingming\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\twhere.xingming = {\r\n\t\t\t\t\t\t[Op.eq]: xingming\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tlet shouji = req.query.shouji\r\n\t\t\tif (shouji) {\r\n\r\n\t\t\t\tif (shouji.indexOf('%') != -1) {\r\n\t\t\t\t\twhere.shouji = {\r\n\t\t\t\t\t\t[Op.like]: shouji\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\twhere.shouji = {\r\n\t\t\t\t\t\t[Op.eq]: shouji\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tlet shenfenzheng = req.query.shenfenzheng\r\n\t\t\tif (shenfenzheng) {\r\n\r\n\t\t\t\tif (shenfenzheng.indexOf('%') != -1) {\r\n\t\t\t\t\twhere.shenfenzheng = {\r\n\t\t\t\t\t\t[Op.like]: shenfenzheng\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\twhere.shenfenzheng = {\r\n\t\t\t\t\t\t[Op.eq]: shenfenzheng\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tlet crossuserid = req.query.crossuserid\r\n\t\t\tif (crossuserid) {\r\n\r\n\t\t\t\tif (crossuserid.indexOf('%') != -1) {\r\n\t\t\t\t\twhere.crossuserid = {\r\n\t\t\t\t\t\t[Op.like]: crossuserid\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\twhere.crossuserid = {\r\n\t\t\t\t\t\t[Op.eq]: crossuserid\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tlet crossrefid = req.query.crossrefid\r\n\t\t\tif (crossrefid) {\r\n\r\n\t\t\t\tif (crossrefid.indexOf('%') != -1) {\r\n\t\t\t\t\twhere.crossrefid = {\r\n\t\t\t\t\t\t[Op.like]: crossrefid\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\twhere.crossrefid = {\r\n\t\t\t\t\t\t[Op.eq]: crossrefid\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t// let tableName = req.session.userinfo.tableName\r\n\t\t\tlet tableName = req.session.userinfo === undefined ? jwt.decode(req.headers.token).tableName : req.session.userinfo.tableName\r\n\t\t\tif(tableName == 'huiyuan') {\r\n\t\t\t\twhere.yonghuming = {\r\n\t\t\t\t\t[Op.eq]: req.session.userinfo === undefined ? jwt.decode(req.headers.token).username : req.session.userinfo.yonghuming\r\n\t\t\t\t}\r\n\t\t\t\tif (where['userid'] != undefined) {\r\n\t\t\t\t\tdelete where.userid\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tlet result = await RuzhujiluModel.findAndCountAll({\r\n\t\t\t\torder: [[sort, order]],\r\n\t\t\t\twhere,\r\n\t\t\t\toffset: (page - 1) * limit,\r\n\t\t\t\tlimit\r\n\t\t\t})\r\n\t\t\t\r\n\t\t\tresult.currPage = page\r\n\t\t\tresult.pageSize = limit\r\n\r\n\t\t\ttoRes.page(res, 0, result)\r\n\t\t} catch(err) {\r\n\r\n\t\t\ttoRes.session(res, 500, '服务器错误！', '', 500)\r\n\t\t}\r\n\t})\r\n\r\n    // 分页接口（前端）\r\n\tapi.get('/list', async (req, res) => {\r\n\r\n\t\ttry {\r\n\r\n\t\t\tlet page = parseInt(req.query.page) || 1\r\n\t\t\tlet limit = parseInt(req.query.limit) || 10\r\n\t\t\tlet sort = req.query.sort || 'id'\r\n\t\t\tlet order = req.query.order || 'asc'\r\n\r\n\t\t\tlet where = {}\r\n\t\t\tlet crossuserid = req.query.crossuserid\r\n\t\t\tif (crossuserid) {\r\n\t\t\t\twhere.crossuserid = {\r\n\t\t\t\t\t[Op.eq]: crossuserid\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tlet crossrefid = req.query.crossrefid\r\n\t\t\tif (crossrefid) {\r\n\t\t\t\twhere.crossrefid = {\r\n\t\t\t\t\t[Op.eq]: crossrefid\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tlet yudingdanhao = req.query.yudingdanhao\r\n\t\t\tif (yudingdanhao) {\r\n\r\n\t\t\t\tif (yudingdanhao.indexOf('%') != -1) {\r\n\t\t\t\t\twhere.yudingdanhao = {\r\n\t\t\t\t\t\t[Op.like]: yudingdanhao\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\twhere.yudingdanhao = {\r\n\t\t\t\t\t\t[Op.eq]: yudingdanhao\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tlet fangjianmingcheng = req.query.fangjianmingcheng\r\n\t\t\tif (fangjianmingcheng) {\r\n\r\n\t\t\t\tif (fangjianmingcheng.indexOf('%') != -1) {\r\n\t\t\t\t\twhere.fangjianmingcheng = {\r\n\t\t\t\t\t\t[Op.like]: fangjianmingcheng\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\twhere.fangjianmingcheng = {\r\n\t\t\t\t\t\t[Op.eq]: fangjianmingcheng\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\r\n\t\t\tlet result = await RuzhujiluModel.findAndCountAll({\r\n\t\t\t\torder: [[sort, order]],\r\n\t\t\t\twhere,\r\n\t\t\t\toffset: (page - 1) * limit,\r\n\t\t\t\tlimit\r\n\t\t\t})\r\n\t\t\t\r\n\t\t\tresult.currPage = page\r\n\t\t\tresult.pageSize = limit\r\n\r\n\t\t\ttoRes.page(res, 0, result)\r\n\t\t} catch(err) {\r\n\t\t\t\r\n\t\t\ttoRes.session(res, 401, '您的权限不够！', '', 200)\r\n\t\t}\r\n\t})\r\n\r\n\r\n\t// 保存接口（后端）\r\n\tapi.post('/save', async (req, res) => {\r\n\r\n\t\ttry {\r\n\r\n\t\t\tObject.keys(req.body).forEach(item=>{\r\n\t\t\t\tif(req.body[item] == '')  delete req.body[item]\r\n\t\t\t})\r\n\r\n\r\n\r\n\t\t\tconst userinfo = await RuzhujiluModel.create(req.body)\r\n\r\n\t\t\tif (userinfo === null) {\r\n\r\n\t\t\t\ttoRes.session(res, -1, '添加失败！')\r\n\t\t\t} else {\r\n\r\n\t\t\t\ttoRes.session(res, 0, '添加成功！')\r\n\t\t\t}\r\n\t\t} catch(err) {\r\n\t\t\t\r\n\t\t\ttoRes.session(res, 500, '服务器错误！', '', 500)\r\n\t\t}\r\n\t})\r\n\r\n    // 保存接口（前端）\r\n\tapi.post('/add', async (req, res) => {\r\n\r\n\t\ttry {\r\n\r\n\t\t\tObject.keys(req.body).forEach(item=>{\r\n\t\t\t\tif(req.body[item] == '')  delete req.body[item]\r\n\t\t\t})\r\n\r\n\t\t\tif (jwt.decode(req.headers.token) == null) {\r\n\t\t\t\ttoRes.session(res, 401, '请登录后再操作', '', 401)\r\n\t\t\t}\r\n\r\n\r\n\r\n\t\t\tconst userinfo = await RuzhujiluModel.create(req.body)\r\n\r\n\t\t\tif (userinfo === null) {\r\n\r\n\t\t\t\ttoRes.session(res, -1, '添加失败！')\r\n\t\t\t} else {\r\n\r\n\t\t\t\ttoRes.session(res, 0, '添加成功！')\r\n\t\t\t}\r\n\t\t} catch(err) {\r\n\t\t\t\r\n\t\t\ttoRes.session(res, 500, '服务器错误！', '', 500)\r\n\t\t}\r\n\t})\r\n\r\n\t// 更新接口\r\n\tapi.post('/update', async (req, res) => {\r\n\r\n\t\ttry {\r\n\r\n\r\n\r\n\t\t\tawait RuzhujiluModel.update(req.body, {\r\n\t\t\t\twhere: {\r\n\t\t\t\t  id: req.body.id || 0\r\n\t\t\t\t}\r\n\t\t\t})\r\n\r\n\r\n\t\t\ttoRes.session(res, 0, '编辑成功！')\r\n\t\t} catch(err) {\r\n\t\t\t\r\n\t\t\ttoRes.session(res, 500, '服务器错误！', '', 500)\r\n\t\t}\r\n\t})\r\n\r\n\t// 删除接口\r\n\tapi.post('/delete', async (req, res) => {\r\n\r\n\t\ttry {\r\n\r\n\t\t\tawait RuzhujiluModel.destroy({\r\n\t\t\t\twhere: {\r\n\t\t\t\t  id: {\r\n\t\t\t\t\t[Op.in]: req.body\r\n\t\t\t\t  }\r\n\t\t\t\t}\r\n\t\t\t})\r\n\r\n\t\t\ttoRes.session(res, 0, '删除成功！')\r\n\t\t} catch(err) {\r\n\r\n\t\t\ttoRes.session(res, 500, '服务器错误！', '', 500)\r\n\t\t}\r\n\t})\r\n\r\n\t// 详情接口（后端）\r\n\tapi.all('/info/:id', async (req, res) => {\r\n\r\n\t\ttry {\r\n\r\n\r\n\t\t\ttoRes.record(res, 0, await RuzhujiluModel.findOne({ where: { id: req.params.id } }))\r\n\t\t} catch(err) {\r\n\r\n\t\t\ttoRes.session(res, 500, '服务器错误！', '', 500)\r\n\t\t}\r\n\t})\r\n\r\n    // 详情接口（前端）\r\n\tapi.all('/detail/:id', async (req, res) => {\r\n\r\n\t\ttry {\r\n\r\n\r\n\t\t\ttoRes.record(res, 0, await RuzhujiluModel.findOne({ where: { id: req.params.id } }))\r\n\t\t} catch(err) {\r\n\r\n\t\t\ttoRes.session(res, 500, '服务器错误！', '', 500)\r\n\t\t}\r\n\t})\r\n\r\n\t// 获取需要提醒的记录数接口\r\n\tapi.get('/remind/:columnName/:type', async (req, res) => {\r\n\r\n\t\ttry {\r\n\r\n\t\t\tlet sql = 'SELECT 0 AS count'\r\n\t\t\t\r\n\t\t\tif (req.params.type == 1) {\r\n\t\t\t\tif (req.query.remindstart) sql = \"SELECT COUNT(*) AS count FROM ruzhujilu WHERE \" + req.params.columnName + \" >= '\" + req.query.remindstart + \"'\"\r\n\t\t\t\tif (req.query.remindend) sql = \"SELECT COUNT(*) AS count FROM ruzhujilu WHERE \" + req.params.columnName + \" <= '\" + req.query.remindend + \"'\"\r\n\r\n\t\t\t\tif (req.query.remindstart && req.query.remindend) {\r\n\t\t\t\t\tsql = \"SELECT COUNT(*) AS count FROM ruzhujilu WHERE \" + req.params.columnName + \" >= '\" + req.query.remindstart + \"' AND \" + req.params.columnName + \" <= '\" + req.query.remindend + \"'\"\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (req.params.type == 2) {\r\n\t\t\t\tif (req.query.remindstart) {\r\n\t\t\t\t\tlet remindStart = util.getDateTimeFormat(0 + Number(req.query.remindstart), \"yyyy-MM-dd\")\r\n\t\t\t\t\tsql = \"SELECT COUNT(*) AS count FROM ruzhujilu WHERE \" + req.params.columnName + \" >= '\" + remindStart + \"'\"\r\n\t\t\t\t}\r\n\t\t\t\tif (req.query.remindend) {\r\n\t\t\t\t\tlet remindEnd = util.getDateTimeFormat(req.query.remindend, \"yyyy-MM-dd\")\r\n\t\t\t\t\tsql = \"SELECT COUNT(*) AS count FROM ruzhujilu WHERE \" + req.params.columnName + \" <= '\" + remindEnd + \"'\"\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (req.query.remindstart && req.query.remindend) {\r\n\t\t\t\t\tlet remindStart = util.getDateTimeFormat(0 + Number(req.query.remindstart), \"yyyy-MM-dd\")\r\n\t\t\t\t\tlet remindEnd = util.getDateTimeFormat(req.query.remindend, \"yyyy-MM-dd\")\r\n\t\t\t\t\tsql = \"SELECT COUNT(*) AS count FROM ruzhujilu WHERE \" + req.params.columnName + \" >= '\" + remindStart + \"' AND \" + req.params.columnName + \" <= '\" + remindEnd + \"'\"\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tconst results = await sequelize.query(sql, {\r\n\t\t\t\tplain: true,\r\n\t\t\t\traw: true,\r\n\t\t\t\ttype: QueryTypes.SELECT\r\n\t\t\t})\r\n\r\n\t\t\ttoRes.count(res, 0, results.count)\r\n\t\t} catch(err) {\r\n\t\t\t\r\n\t\t\ttoRes.session(res, 500, '服务器错误！', '', 500)\r\n\t\t}\r\n\t})\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\t// 分组统计接口\r\n\tapi.get('/group/:columnName', async (req, res) => {\r\n\r\n\t\ttry {\r\n\r\n\t\t\tlet sql = \"\"\r\n\t\t\tlet columnName = req.params.columnName\r\n\t\t\t// let tableName = \"ruzhujilu\"\r\n\t\t\tlet where = \" WHERE 1 = 1 \"\r\n\t\t\tlet tableName = req.session.userinfo === undefined ? jwt.decode(req.headers.token).tableName : req.session.userinfo.tableName\r\n\t\t\tif(tableName == 'huiyuan') {\r\n\t\t\t\twhere += \" AND yonghuming = '\" + jwt.decode(req.headers.token).username + \"' \";\r\n\t\t\t}\r\n\t\t\tsql = \"SELECT COUNT(*) AS total, \" + columnName + \" FROM ruzhujilu \" + where + \" GROUP BY \" + columnName + \" LIMIT 10\" \r\n\t\t\ttoRes.record(res, 0, await sequelize.query(sql, {\r\n\t\t\t\tplain: false,\r\n\t\t\t\traw: true,\r\n\t\t\t\ttype: QueryTypes.SELECT\r\n\t\t\t}))\r\n\t\t} catch(err) {\r\n\r\n\t\t\ttoRes.session(res, 500, '服务器错误！', '', 500)\r\n\t\t}\r\n\t})\r\n\r\n\t// 统计指定字段\r\n\tapi.get('/value/:xColumnName/:yColumnName', async (req, res) => {\r\n\r\n\t\ttry {\r\n\r\n\t\t\tlet sql = \"\"\r\n\t\t\tlet xColumnName = req.params.xColumnName\r\n\t\t\tlet yColumnName = req.params.yColumnName\r\n\t\t\t// let tableName = \"ruzhujilu\"\r\n\t\t\tlet where = \" WHERE 1 = 1 \"\r\n\t\t\tlet tableName = req.session.userinfo === undefined ? jwt.decode(req.headers.token).tableName : req.session.userinfo.tableName\r\n\t\t\tif(tableName == 'huiyuan') {\r\n\t\t\t\twhere += \" AND yonghuming = '\" + jwt.decode(req.headers.token).username + \"' \";\r\n\t\t\t}\r\n\t\t\tif (\"ruzhujilu\" == \"orders\") {\r\n\t\t\t\twhere += \" AND status IN ('已支付', '已发货', '已完成') \";\r\n\t\t\t}\r\n\r\n\t\t\tsql = \"SELECT \" + xColumnName + \", SUM(\" + yColumnName + \") AS total FROM ruzhujilu \" + where + \" GROUP BY \" + xColumnName + \" DESC LIMIT 10\"\r\n\t\t\t\r\n\t\t\ttoRes.record(res, 0, await sequelize.query(sql, {\r\n\t\t\t\tplain: false,\r\n\t\t\t\traw: true,\r\n\t\t\t\ttype: QueryTypes.SELECT\r\n\t\t\t}))\r\n\t\t} catch(err) {\r\n\r\n\t\t\ttoRes.session(res, 500, '服务器错误！', '', 500)\r\n\t\t}\r\n\t})\r\n\r\n\t// 按日期统计\r\n\tapi.get('/value/:xColumnName/:yColumnName/:timeStatType', async (req, res) => {\r\n\r\n\t\ttry {\r\n\t\t\t\r\n\t\t\tlet sql = \"\"\r\n\t\t\tlet xColumnName = req.params.xColumnName\r\n\t\t\tlet yColumnName = req.params.yColumnName\r\n\t\t\tlet timeStatType = req.params.timeStatType\r\n\t\t\tlet tableName = \"ruzhujilu\"\r\n\t\t\tlet where = \" WHERE 1 = 1 \"\r\n\t\t\tif (jwt.decode(req.headers.token).role != '管理员') {\r\n\t\t\t\twhere += \" AND yonghuming = '\" + jwt.decode(req.headers.token).username + \"' \";\r\n\t\t\t}\r\n\t\t\tif (\"ruzhujilu\" == \"orders\") {\r\n\t\t\t\twhere += \" AND status IN ('已支付', '已发货', '已完成') \";\r\n\t\t\t}\r\n\r\n            if (config.dbConnection.dbtype.toLowerCase() == \"mysql\") {\r\n                if (timeStatType == \"日\")\r\n                    sql = \"SELECT DATE_FORMAT(\" + xColumnName + \", '%Y-%m-%d') \" + xColumnName + \", sum(\" + yColumnName + \") total FROM \" + tableName + where + \" GROUP BY DATE_FORMAT(\" + xColumnName + \", '%Y-%m-%d') LIMIT 10\";\r\n                if (timeStatType == \"月\")\r\n                    sql = \"SELECT DATE_FORMAT(\" + xColumnName + \", '%Y-%m') \" + xColumnName + \", sum(\" + yColumnName + \") total FROM \" + tableName + where + \" GROUP BY DATE_FORMAT(\" + xColumnName + \", '%Y-%m')  LIMIT 10\";\r\n                if (timeStatType == \"年\")\r\n                    sql = \"SELECT DATE_FORMAT(\" + xColumnName + \", '%Y') \" + xColumnName + \", sum(\" + yColumnName + \") total FROM \" + tableName + where + \" GROUP BY DATE_FORMAT(\" + xColumnName + \", '%Y')  LIMIT 10\";\r\n            } else {\r\n                if (timeStatType == \"日\")\r\n                    sql = \"SELECT DATE_FORMAT(VARCHAR(10),\" + xColumnName + \", 120) \" + xColumnName + \", sum(\" + yColumnName + \") total FROM \" + tableName + where + \" GROUP BY DATE_FORMAT(VARCHAR(10),\" + xColumnName + \", 120)  LIMIT 10\";\r\n                if (timeStatType == \"月\")\r\n                    sql = \"SELECT DATE_FORMAT(VARCHAR(7),\" + xColumnName + \", 120) \" + xColumnName + \", sum(\" + yColumnName + \") total FROM \" + tableName + where + \" GROUP BY DATE_FORMAT(VARCHAR(7),\" + xColumnName + \", 120)  LIMIT 10\";\r\n                if (timeStatType == \"年\")\r\n                    sql = \"SELECT DATE_FORMAT(VARCHAR(4),\" + xColumnName + \", 120) \" + xColumnName + \", sum(\" + yColumnName + \") total FROM \" + tableName + where + \" GROUP BY DATE_FORMAT(VARCHAR(4),\" + xColumnName + \", 120)  LIMIT 10\";\r\n            }\r\n\t\t\ttoRes.record(res, 0, await sequelize.query(sql, {\r\n\t\t\t\tplain: false,\r\n\t\t\t\traw: true,\r\n\t\t\t\ttype: QueryTypes.SELECT\r\n\t\t\t}))\r\n\t\t} catch(err) {\r\n\r\n\t\t\ttoRes.session(res, 500, '服务器错误！', '', 500)\r\n\t\t}\r\n\t})\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\treturn api\r\n}\r\n"]}