{"version":3,"sources":["../../src/lib/toRes.js"],"names":["session","res","code","msg","token","status","result","json","file","count","record","data","page","total","pageSize","totalPage","Math","ceil","currPage","list","rows","auth","req","role","userinfo","split","find","item"],"mappings":";;;;;kBACe;AAEdA,QAFc,mBAELC,GAFK,EAE2C;AAAA,MAA3CC,IAA2C,uEAAtC,CAAsC;AAAA,MAAnCC,GAAmC,uEAA/B,OAA+B;AAAA,MAAtBC,KAAsB,uEAAhB,EAAgB;AAAA,MAAZC,MAAY,uEAAL,GAAK;;;AAExD,MAAIC,SAAS;AACZJ,aADY;AAEZC;AAFY,GAAb;;AAKA,MAAIC,UAAU,EAAd,EAAkBE,OAAOF,KAAP,GAAeA,KAAf;;AAElBH,MAAII,MAAJ,CAAWA,MAAX,EAAmBE,IAAnB,CAAwBD,MAAxB;AACA,EAZa;AAadE,KAbc,gBAaRP,GAbQ,EAauC;AAAA,MAA1CC,IAA0C,uEAArC,CAAqC;;AAAA,MAAlCM,KAAkC,uEAA7B,EAA6B;;AAAA,MAAzBL,GAAyB,uEAArB,OAAqB;AAAA,MAAZE,MAAY,uEAAL,GAAK;;;AAEpDJ,MAAII,MAAJ,CAAWA,MAAX,EAAmBE,IAAnB,CAAwB;AACvBL,aADuB;AAEvBM,cAFuB;AAGvBL;AAHuB,GAAxB;AAKA,EApBa;AAqBdM,MArBc,iBAqBPR,GArBO,EAqByC;AAAA,MAA3CC,IAA2C,uEAAtC,CAAsC;;AAAA,MAAnCO,MAAmC,uEAA7B,EAA6B;;AAAA,MAAzBN,GAAyB,uEAArB,OAAqB;AAAA,MAAZE,MAAY,uEAAL,GAAK;;;AAEtDJ,MAAII,MAAJ,CAAWA,MAAX,EAAmBE,IAAnB,CAAwB;AACvBL,aADuB;AAEvBO,gBAFuB;AAGvBN;AAHuB,GAAxB;AAKA,EA5Ba;AA6BdO,OA7Bc,kBA6BNT,GA7BM,EA6ByC;AAAA,MAA1CC,IAA0C,uEAArC,CAAqC;AAAA,MAAlCS,IAAkC,uEAA7B,EAA6B;AAAA,MAAzBR,GAAyB,uEAArB,OAAqB;AAAA,MAAZE,MAAY,uEAAL,GAAK;;;AAEtDJ,MAAII,MAAJ,CAAWA,MAAX,EAAmBE,IAAnB,CAAwB;AACvBL,aADuB;AAEvBC,WAFuB;AAGvBQ;AAHuB,GAAxB;AAKA,EApCa;AAqCdC,KArCc,gBAqCRX,GArCQ,EAqCyC;AAAA,MAA5CC,IAA4C,uEAAvC,CAAuC;AAAA,MAApCI,MAAoC,uEAA7B,EAA6B;AAAA,MAAzBH,GAAyB,uEAArB,OAAqB;AAAA,MAAZE,MAAY,uEAAL,GAAK;;;AAEtDJ,MAAII,MAAJ,CAAWA,MAAX,EAAmBE,IAAnB,CAAwB;AACvBL,aADuB;AAEvBC,WAFuB;AAGvBQ,SAAM;AACLE,WAAOP,OAAOG,KADT;AAELK,cAAUR,OAAOQ,QAFZ;AAGLC,eAAWT,OAAOG,KAAP,GAAeH,OAAOQ,QAAtB,IAAkC,CAAlC,GAAsCR,OAAOG,KAAP,GAAeH,OAAOQ,QAA5D,GAAuEE,KAAKC,IAAL,CAAUX,OAAOG,KAAP,GAAeH,OAAOQ,QAAhC,CAH7E;AAILI,cAAUZ,OAAOY,QAJZ;AAKLC,UAAMb,OAAOc;AALR;AAHiB,GAAxB;AAWA,EAlDa;AAmDdC,KAnDc,gBAmDRC,GAnDQ,EAmDHrB,GAnDG,EAmDEsB,IAnDF,EAmDQ;;AAErB,MAAID,IAAItB,OAAJ,CAAYwB,QAAZ,IAAwB,CAACD,KAAKE,KAAL,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,gBAAQ;AAAC,UAAOC,SAASL,IAAItB,OAAJ,CAAYwB,QAAZ,CAAqBD,IAArC;AAA0C,GAAxE,CAA7B,EAAwG;AACvGtB,OAAII,MAAJ,CAAW,GAAX,EAAgBE,IAAhB,CAAqB;AACpBL,UAAM,GADc;AAEpBC,SAAK;AAFe,IAArB;;AAKA,UAAO,KAAP;AACA;;AAED,SAAO,IAAP;AACA;AA/Da,C","file":"toRes.js","sourcesContent":["\nexport default {\n\n\tsession (res, code=0, msg='操作成功！', token='', status=200) {\n\n\t\tlet result = {\n\t\t\tcode,\n\t\t\tmsg\n\t\t}\n\n\t\tif (token !== '') result.token = token\n\n\t\tres.status(status).json(result)\n\t},\n\tfile (res, code=0, file='', msg='上传成功！', status=200) {\n\n\t\tres.status(status).json({\n\t\t\tcode,\n\t\t\tfile,\n\t\t\tmsg\n\t\t})\n\t},\n\tcount (res, code=0, count='', msg='请求成功！', status=200) {\n\n\t\tres.status(status).json({\n\t\t\tcode,\n\t\t\tcount,\n\t\t\tmsg\n\t\t})\n\t},\n\trecord (res, code=0, data={}, msg='请求成功！', status=200) {\n\n\t\tres.status(status).json({\n\t\t\tcode,\n\t\t\tmsg,\n\t\t\tdata\n\t\t})\n\t},\n\tpage (res, code=0, result={}, msg='请求成功！', status=200) {\n\n\t\tres.status(status).json({\n\t\t\tcode,\n\t\t\tmsg,\n\t\t\tdata: {\n\t\t\t\ttotal: result.count,\n\t\t\t\tpageSize: result.pageSize,\n\t\t\t\ttotalPage: result.count % result.pageSize == 0 ? result.count / result.pageSize : Math.ceil(result.count / result.pageSize) ,\n\t\t\t\tcurrPage: result.currPage,\n\t\t\t\tlist: result.rows\n\t\t\t}\n\t\t})\n\t},\n\tauth (req, res, role) {\n\n\t\tif (req.session.userinfo && !role.split(',').find(item => {return item === req.session.userinfo.role})) {\n\t\t\tres.status(200).json({\n\t\t\t\tcode: 401,\n\t\t\t\tmsg: '您的权限不够！'\n\t\t\t})\n\n\t\t\treturn false\n\t\t}\n\n\t\treturn true\n\t}\n}\n"]}